{% extends "base.html" %}

{% block title %}Shop.CO - {{ category_name }}{% endblock %}

{% block content %}


    <div style="display: flex; flex-direction: column; align-items: center;">
        <nav class="hero-breadcrumbs">
            <a href="{{ url_for('main.home') }}">
                <p>Home</p>
                <img class="breadcrums_arrow" src="{{ url_for('static' , filename='img/breadcrums arrow.svg')}}" width="10.4px" height="18,4px">
            </a>
            <a href="{{ url_for('main.category', category_name=category_slug) }}">
                <p>{{ category_name }}</p>
                <img class="breadcrums_arrow" src="{{ url_for('static' , filename='img/breadcrums arrow.svg')}}" width="10.4px" height="18,4px">
            </a>
        </nav>

        <h1 style="text-align: center; margin-bottom: 65px; font-size: 45px;">{{ category_name }}</h1>
    </div>

    <div class="main-content">
            <ul class="Category">
                {% for product in products %}
                <li class="Category-item">
                    <a class="wrapper-clothes-img" href="{{ url_for('main.product', id=product.id) }}">
                        <img class="clothes-img" 
                             src="{{ url_for('static', filename='img/' + product.image) }}" 
                             width="295" 
                             height="298" 
                             alt="{{ product.name }}">
                    </a>
                    
                    <h3 class="clothes-name">{{ product.name }}</h3>
                    
                    <div class="Category-item-mark">
                        <ul class="Category-item-stars">
                            {% set full_stars = product.rating|int %}
                            {% set has_half = product.rating - full_stars >= 0.5 %}
                            
                            {% for i in range(full_stars) %}
                            <li><img src="{{ url_for('static', filename='img/Star 5.svg') }}" width="18" height="18" alt="star"></li>
                            {% endfor %}
                            
                            {% if has_half %}
                            <li class="half"><img src="{{ url_for('static', filename='img/Half_star.svg') }}" width="18" height="18" alt="star"></li>
                            {% endif %}

                        </ul>
                        
                        <p class="Category-item-assessment assessment">
                            <span class="black">{{ "%.1f"|format(product.rating) }}/</span>
                            <span>5</span>
                        </p>
                    </div>
                    
                    <div class="Category-item-prices">
                        {% if product.old_price %}
                        <p class="price_now">${{ "%.2f"|format(product.price) }}</p>
                        <p class="price_was">${{ "%.2f"|format(product.old_price) }}</p>
                        {% set discount = ((product.old_price - product.price) / product.old_price * 100)|int %}
                        <p class="price_sale">-{{ discount }}%</p>
                        {% else %}
                        <p class="price">${{ "%.2f"|format(product.price) }}</p>
                        {% endif %}
                    </div>
                </li>
                {% endfor %}
            </ul>
        </section>
    </div>
{% endblock %}